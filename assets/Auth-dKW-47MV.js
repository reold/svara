import{b as ke,w as K,f as g,s as v,g as i,S as _e,y as p,A as w,D as T,e as s,a as ye,M as Be,O as Se,u as R,I as ze,ab as Y,ac as k,z as _,c as m,i as J,G as Ae,K as $,a0 as Q,B as y,d as Te}from"./index-DKE6VTDk.js";import{b as V}from"./input-4i5Z-8WO.js";import{m as M}from"./services.svelte-B215XA2r.js";var Je=g(`No JioSaavn email address? <a class="text-blue-600/85 dark:text-blue-500/85 after:content-['_â†—']" href="https://help.jiosaavn.com/hc/en-us/articles/360020256612-How-do-I-change-or-add-my-name-email-ID-or-mobile-number-on-my-account" target="_blank">Learn how to add one</a>`,1),Ve=g('<span class="text-sm"> </span>'),Me=g('<input type="email" autocomplete="email" spellcheck="false" inputmode="email" id="email-input" class="px-2.5 pb-2.5 pt-4 w-full text-[16px] text-black dark:text-white bg-transparent rounded-lg ring-1 ring-black/50 dark:ring-white/50 invalid:ring-red-600 dark:invalid:ring-red-500 dark:focus:ring-blue-500 focus:outline-hidden focus:ring-blue-600 peer appearance-none" placeholder=" "/> <label for="email-input" class="absolute text-sm text-black/75 dark:text-white/75 duration-300 transform -translate-y-4 scale-[85%] px-1.5 top-2 z-10 origin-[0] bg-white dark:bg-black peer-focus:px-1.5 peer-focus:text-blue-600 dark:peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-[85%] peer-focus:-translate-y-4 peer-focus:rtl:translate-x-1/4 peer-focus:rtl:left-auto start-1">email address</label>',1),Oe=g('<input type="password" autocomplete="current-password" inputmode="text" spellcheck="false" aria-describedby="password-info" id="password-input" minlength="7" class="px-2.5 pb-2.5 pt-4 w-full text-[16px] text-black dark:text-white bg-transparent rounded-lg ring-1 ring-black/50 dark:ring-white/50 invalid:ring-red-600 dark:invalid:ring-red-500 dark:focus:ring-blue-500 focus:outline-hidden focus:ring-blue-600 peer appearance-none" placeholder=" "/> <label for="password-input" class="absolute text-sm text-black/75 dark:text-white/75 duration-300 transform -translate-y-4 scale-[85%] px-1.5 top-2 z-10 origin-[0] bg-white dark:bg-black peer-focus:px-1.5 peer-focus:text-blue-600 dark:peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-[85%] peer-focus:-translate-y-4 peer-focus:rtl:translate-x-1/4 peer-focus:rtl:left-auto start-1">password</label>',1),je=g('<input type="text" id="otp-input" inputmode="numeric" autocomplete="off" aria-label="one-time password" pattern="\\d*" maxlength="10" class="px-2.5 pb-2.5 pt-4 w-full text-[16px] text-black dark:text-white bg-transparent rounded-lg ring-1 ring-black/50 dark:ring-white/50 invalid:ring-red-600 dark:invalid:ring-red-500 dark:focus:ring-blue-500 focus:outline-hidden focus:ring-blue-600 peer appearance-none" placeholder=" "/> <label for="otp-input" class="absolute text-sm text-black/75 dark:text-white/75 duration-300 transform -translate-y-4 scale-[85%] px-1.5 top-2 z-10 origin-[0] bg-white dark:bg-black peer-focus:px-1.5 peer-focus:text-blue-600 dark:peer-focus:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-[85%] peer-focus:-translate-y-4 peer-focus:rtl:translate-x-1/4 peer-focus:rtl:left-auto start-1">one-time password</label>',1),Ce=g('<div class="ring-1 ring-black/50 dark:ring-white/50 mb-[1ch] p-1 rounded-md"><p class="font-bold"><span class="text-xs bg-yellow-600 dark:bg-yellow-500 text-white dark:text-black p-1 rounded-md"> </span> </p> <span class="text-[10px] bg-black/50 dark:bg-white/50 p-0.5 text-white dark:text-black"> </span></div>'),Ie=Ae('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-[1.2em] inline animate-spin" style="animation-duration: 0.75s;"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"></path></svg>'),Le=g('<button type="button"><span>cancel</span></button>'),Pe=g(`<div class="w-dvw h-dvh bg-black flex flex-col items-center justify-center" style="background-size: 40px 40px;
  background-image: radial-gradient(circle, #FFF 1px, rgba(0, 0, 0, 0) 1px);"><div><div class="flex flex-row items-center justify-end space-x-[2ch] relative"><p class="text-xs absolute left-0">Svara-JioSaavn Authenticator<br/>developmental beta</p> <!> <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="size-[5dvh] fill-black dark:fill-white"><title>Jio</title><path d="M12 0A12 12 0 1 1 0 12 12 12 0 0 1 12 0m5.587 14.559c-.883 0-1.49-.648-1.49-1.574 0-.912.62-1.56 1.49-1.56s1.491.648 1.491 1.573c0 .897-.634 1.56-1.49 1.56zm.03-5.152c-2.265 0-3.772 1.437-3.772 3.576 0 2.195 1.451 3.604 3.729 3.604 2.264 0 3.755-1.409 3.755-3.59 0-2.153-1.475-3.59-3.713-3.59zM11.78 6.272c-.856 0-1.395.483-1.395 1.243 0 .774.552 1.257 1.435 1.257.857 0 1.395-.483 1.395-1.257s-.552-1.243-1.435-1.243m.152 3.204h-.277c-.675 0-1.187.317-1.187 1.285v4.42c0 .98.496 1.284 1.216 1.284h.275c.677 0 1.16-.33 1.16-1.285v-4.419c0-.995-.47-1.285-1.187-1.285M8.316 7.392h-.4c-.76 0-1.174.43-1.174 1.285v4.13c0 1.063-.36 1.436-1.2 1.436-.662 0-1.201-.29-1.63-.816C3.87 13.373 3 13.786 3 14.81c0 1.104 1.035 1.781 2.955 1.781 2.334 0 3.563-1.173 3.563-3.742V8.675c0-.856-.413-1.283-1.202-1.283"></path></svg></div> <div class="h-px w-full bg-black/50 dark:bg-white/50 my-[1ch]"></div> <h1 class="text-3xl font-bold mt-[2ch]"><!></h1> <p class="-mt-0.5 text-black/75 dark:text-white/75"><!> <!></p> <div class="relative mt-[4ch]"><!></div> <button type="button"><!> <span>continue</span></button> <!></div></div>`);function qe(U,W){ke(W,!0);const O=()=>ze(Y,"$config",X),[X,Z]=Be(),r=K({email:{ele:{},value:""},password:{ele:{},value:""},otp:{ele:{},value:""}}),a=K({loading:!1,phase:"email",infoBuild:{}}),ee=()=>{switch(a.phase){case"email":if(!r.email.ele.checkValidity()){r.email.ele.reportValidity();return}const e=r.email.value;if(e.length<2)return;a.loading=!0,M.auth.validateEmail(e).then(l=>{l==!0?(a.infoBuild.email=e,a.phase="password"):alert(`The provided email address is not registered with JioSaavn! (${e})`),a.loading=!1});break;case"password":const t=r.password.value;if(!r.password.ele.checkValidity()){r.password.ele.reportValidity();return}if(t.length<7)return;a.loading=!0,M.auth.requestOTP(a.infoBuild.email,t).then(l=>{l==!0?a.phase="otp":alert(`The provided password is incorrect (${a.infoBuild.email})`),a.loading=!1});break;case"otp":const n=r.otp.value;if(!r.otp.ele.checkValidity()){r.otp.ele.reportValidity();return}a.loading=!0,M.auth.validateOTP(a.infoBuild.email,n).then(l=>{l.status&&l.status=="success"?(a.infoBuild={...a.infoBuild,profile:l.data,sessionToken:l.sessionToken},a.phase="complete",Se(Y,R(O).connections.jiosaavn={data:{meta:l.data,token:l.sessionToken},active:!0},R(O))):alert(`The provided otp is incorrect (${a.infoBuild.email})`),a.loading=!1});break;default:window.location.href="#dash"}};var j=Pe(),C=i(j);let I;var L=i(C),ae=v(i(L),2);_e(ae,{class:"size-[5dvh]"});var P=v(L,4),te=i(P);{var re=e=>{var t=k("JioSaavn Link Success!");s(e,t)},le=e=>{var t=k(`Link
        JioSaavn`);s(e,t)};p(te,e=>{a.phase=="complete"?e(re):e(le,!1)})}var F=v(P,2),D=i(F);{var se=e=>{var t=k(`Authorized Svara access to your JioSaavn
        account.`);s(e,t)},oe=e=>{var t=k("Authorize Svara access to your JioSaavn account.");s(e,t)};p(D,e=>{a.phase=="complete"?e(se):e(oe,!1)})}var ie=v(D,2);{var ne=e=>{var t=Je();s(e,t)},de=e=>{var t=_(),n=m(t);{var l=o=>{var d=Ve(),f=i(d);w(()=>y(f,`Your credentials are used only for authentication and never stored.
          An OTP will be sent to ${a.infoBuild.email??""}.`)),s(o,d)},z=o=>{var d=_(),f=m(d);{var c=b=>{var u=k();w(()=>y(u,`Continue with the OTP delivered to ${a.infoBuild.email??""}.`)),s(b,u)};p(f,b=>{a.phase=="otp"&&b(c)},!0)}s(o,d)};p(n,o=>{a.phase=="password"?o(l):o(z,!1)},!0)}s(e,t)};p(ie,e=>{a.phase=="email"?e(ne):e(de,!1)})}var N=v(F,2),pe=i(N);{var ce=e=>{var t=Me(),n=m(t);J(n,l=>r.email.ele=l,()=>{var l;return(l=r==null?void 0:r.email)==null?void 0:l.ele}),V(n,()=>r.email.value,l=>r.email.value=l),s(e,t)},ue=e=>{var t=_(),n=m(t);{var l=o=>{var d=Oe(),f=m(d);J(f,c=>r.password.ele=c,()=>{var c;return(c=r==null?void 0:r.password)==null?void 0:c.ele}),V(f,()=>r.password.value,c=>r.password.value=c),s(o,d)},z=o=>{var d=_(),f=m(d);{var c=u=>{var x=je(),S=m(x);J(S,h=>r.otp.ele=h,()=>{var h;return(h=r==null?void 0:r.otp)==null?void 0:h.ele}),V(S,()=>r.otp.value,h=>r.otp.value=h),s(u,x)},b=u=>{var x=_(),S=m(x);{var h=A=>{var E=Ce(),G=i(E),H=i(G),ge=i(H),be=v(H),xe=v(G,2),we=i(xe);w(()=>{y(ge,a.infoBuild.profile.status),y(be,` ${a.infoBuild.profile.firstname??""} (${a.infoBuild.profile.username??""})`),y(we,`SVARAJIOSAAVN_ ${a.infoBuild.profile.uid??""}`)}),s(A,E)};p(S,A=>{a.phase=="complete"&&A(h)},!0)}s(u,x)};p(f,u=>{a.phase=="otp"?u(c):u(b,!1)},!0)}s(o,d)};p(n,o=>{a.phase=="password"?o(l):o(z,!1)},!0)}s(e,t)};p(pe,e=>{a.phase=="email"?e(ce):e(ue,!1)})}var B=v(N,2);B.__click=ee;let q;var ve=i(B);{var fe=e=>{var t=Ie();$(3,t,()=>Q,()=>({duration:500})),s(e,t)};p(ve,e=>{a.loading&&e(fe)})}var he=v(B,2);{var me=e=>{var t=Le();t.__click=()=>{window.location.hash="#dash"};let n;w(()=>n=T(t,1,"w-full text-sm bg-black/25 dark:bg-white/15 dark:text-white text-black rounded-lg mt-2.5",null,n,{"animate-pulse":a.loading})),$(3,t,()=>Q,()=>({duration:500})),s(e,t)};p(he,e=>{a.phase=="email"&&a.loading==!1&&e(me)})}w(()=>{I=T(C,1,"w-[90%] max-w-120 bg-white text-black dark:bg-black dark:text-white rounded-md p-2.5 ring-1 ring-black/50 dark:ring-white/50",null,I,{"pointer-events-none":a.loading}),q=T(B,1,"w-full text-sm bg-blue-600 dark:bg-blue-500 text-white dark:text-black rounded-lg mt-2.5",null,q,{"animate-pulse":a.loading})}),s(U,j),ye(),Z()}Te(["click"]);export{qe as default};
