import{b as be,w as Y,o as xe,f as b,c as w,s as h,g as v,h as Z,j as ee,y as I,l as n,A as M,R as B,I as ae,W as te,D as J,K as D,U as ye,a0 as re,e as u,a as ke,M as _e,V as F,E as N,B as Q,F as we,ab as $e,z as T,d as Se,ay as Ie,O as se,u as q,J as je}from"./index-vMURVn30.js";import{b as ze}from"./input-QVxv62AN.js";import{J as A,T as ie}from"./source.svelte-ilpGIhIP.js";import{u as C}from"./Dash-8diNvjoU.js";import"./ShapesSolid-dru5X_nM.js";import"./services.svelte-Ce5PAndT.js";import"./svelte-head-Cnxyuz5S.js";import"./Sheet-yVx4Komk.js";import"./ssh-Dd9KgggB.js";import"./legacy-Bufrj_iA.js";var Le=b('<button class="p-0 m-0 h-[75%] max-w-[5%] bg-transparent" aria-label="clear search text"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-[1.3em] text-zinc-500"><path fill-rule="evenodd" d="M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16ZM8.28 7.22a.75.75 0 0 0-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 1 0 1.06 1.06L10 11.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L11.06 10l1.72-1.72a.75.75 0 0 0-1.06-1.06L10 8.94 8.28 7.22Z" clip-rule="evenodd"></path></svg></button>'),Me=b("<button> </button>"),Je=b('<div class="w-full h-[calc(var(--spacing)*18)] pl-1.5 ring-zinc-500 text-black dark:text-white overflow-hidden flex flex-row border-b-0 border-black/5 dark:border-white/5 select-none transition-colors duration-100 bg-gradient-to-r from-zinc-600 to-zinc-500 animate-pulse" role="button"></div>'),Te=b('<div class="py-1 px-2 flex flex-col items-end"><ul class="space-x-2"></ul></div> <!>',1),qe=b("<span>Svara is connected with <b> </b> </span>"),Ae=b('<div class="px-2"><h1 class="text-black dark:text-white font-semibold text-center mt-[1em] mb-2 text-xl border-b border-black/10 dark:border-white/10">ðŸŽ¶ Search for Music!</h1> <p class="text-black/80 dark:text-white/80 text-sm">Find for your favorite songs, playlists, artists and more! <!></p></div>'),Ce=b('<div class="p-2 pb-1 text-black dark:text-white h-[7dvh]"><div class="relative w-full bg-black/5 dark:bg-white/5 ring-1 ring-black/10 dark:ring-white/10 rounded-md flex flex-row items-center justify-center space-x-[0.2ch] text-[16px] h-full px-[1ch]"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"></path></svg> <input type="text" placeholder="find songs &amp; playlists"/> <!></div></div> <div><!></div>',1);function Qe(ne,le){be(le,!0);const x=()=>ae(F,"$ViewInfo",W),R=()=>ae($e,"$config",W),[W,oe]=_e();let t=Y({loading:!1}),s=Y({text:"",kind:"track"}),V=ee(!1),E=ee("");const de=(e,a=500)=>{let i=null;return(...o)=>{i||(i=setTimeout(()=>{e(...o),i=null},a))}},ce=async(e,a,i)=>{const o=Date.now(),l=`cache-${e}`;if(localStorage.getItem(l)){if(!localStorage.getItem(l))return;const f=JSON.parse(localStorage.getItem(l));if(f){if(o<f.expiry)return{content:f.data,hit:!0};localStorage.removeItem(l)}}const m=await a();return localStorage.setItem(l,JSON.stringify({data:m,expiry:o+i})),{content:m,hit:!1}},K=de(()=>{var a,i;let e=s.text;!e||e.length<3||s.kind=="playlist"&&t.playlists&&((a=t.playlists)==null?void 0:a.query)==e||s.kind=="track"&&t.songs&&((i=t.songs)==null?void 0:i.query)==e||(t.loading=!0,ce(`search-${s.kind}-${e}`,()=>A.query(e,{kind:s.kind}),60*60*1e3).then(o=>{if(!o)return;let l=o.content;switch(t.query=e,s.kind){case"playlist":t.playlists={...l,query:e};break;case"track":t.songs={...l,query:e};break}t.loading=!1}))},1e3);xe(()=>{s.kind,K()});var G=Ce(),O=w(G),H=v(O),X=v(H),j=h(X,2);j.__keyup=e=>{const a=e.target;if(e.key=="Enter"){a.blur();return}a.value=a.value.replace(/[^a-zA-Z0-9 '-]/g,""),s.text=a.value.trim(),s.text!=""&&(Z(V,a.value.length>2),K())};var ue=h(j,2);{var pe=e=>{var a=Le();a.__click=()=>Z(E,""),D(3,a,()=>re,()=>({duration:100})),u(e,a)};I(ue,e=>{n(V)&&e(pe)})}var z=h(O,2),ve=v(z);{var me=e=>{var a=Te(),i=w(a),o=v(i);N(o,20,()=>[{name:"songs",value:"track"},{name:"playlists",value:"playlist"}],we,(d,c)=>{var p=Me();p.__click=()=>s.kind=c.value;var g=v(p);M(()=>{J(p,1,`py-0 px-2 text-sm h-9 rounded-md ring-1 ring-black/20 dark:ring-white/20 ${s.kind==c.value?"bg-black/20 dark:bg-white/20":"bg-black/5 dark:bg-white/5"}`),Q(g,c.name)}),u(d,p)});var l=h(i,2);{var m=d=>{var c=T(),p=w(c);N(p,17,()=>t.playlists.results||[],g=>g.id,(g,y)=>{ie(g,{get track(){return n(y)},onPlay:async()=>{(await A.helpers.fetchPlaylist(n(y).id)).list.forEach(async(r,$)=>{var S;const k=await A.getDownloadableURLs(r);if(k.length==0){console.error("no media url found for track");return}const L=(S=k.at(-1))==null?void 0:S.url;switch(r.image=r.image.replace("http://","https://").replace("150x150","500x500"),$){case 0:C.playback.play({id:r.id,title:r.title,img:r.image,artist:r.more_info.artistMap.primary_artists[0].name||"",album:r.more_info.album||"",colors:{primary:"#7008e7",secondary:"#7008e7"}},L);break;default:await C.playback.appendQueue({id:r.id,title:r.title,img:r.image,artist:r.more_info.artistMap.primary_artists[0].name||"",album:r.more_info.album||""},L)}})}})}),u(d,c)},f=d=>{var c=T(),p=w(c);{var g=y=>{var P=T(),r=w(P);N(r,19,()=>t.songs.results||[],$=>$.id,($,k,L)=>{var S=T(),he=w(S);Ie(he,()=>A.helpers.toTrackT(n(k)),U=>{var _=Je();M(()=>B(_,`animation-delay: ${n(L)*50}ms;`)),u(U,_)},(U,_)=>{{let ge=je(()=>C.info.meta.id==n(k).id);ie(U,{get track(){return n(k)},get playing(){return n(ge)},onPlay:async()=>{C.playback.play(n(_).meta,n(_).url)},onMoreActions:()=>{se(F,q(x).sheets.actions=!0,q(x)),se(F,q(x).select.track=n(_),q(x))}})}}),u($,S)}),u(y,P)};I(p,y=>{s.kind=="track"&&y(g)},!0)}u(d,c)};I(l,d=>{s.kind=="playlist"&&t.playlists?d(m):d(f,!1)})}u(e,a)},fe=e=>{var a=Ae(),i=h(v(a),2),o=h(v(i));{var l=m=>{var f=qe(),d=h(v(f)),c=v(d),p=h(d);M(()=>{Q(c,`${R().connections.jiosaavn.data.meta.firstname??""}'s`),Q(p,`(${R().connections.jiosaavn.data.meta.username??""}) JioSaavn
            Account.`)}),u(m,f)};I(o,m=>{R().connections.jiosaavn.active&&m(l)})}u(e,a)};I(ve,e=>{t.songs?e(me):e(fe,!1)})}M(()=>{B(O,`display: ${x().tab==te.search?"block":"none"};`),J(X,0,`h-[1.3em] max-w-[5%] ${t.loading?"animate-pulse text-purple-600 dark:text-purple-500 stroke-2":"text-zinc-500"}`),J(j,1,`bg-transparent ring-0 border-hidden focus:outline-hidden rounded-md py-0 h-full placeholder:text-black/50 dark:placeholder:text-white/50 ${n(V)?"w-[90%]":"w-[95%]"}`),J(z,1,`relative items-center justify-center space-y-0 max-h-[93dvh] h-[93dvh] overflow-y-scroll pb-[20dvh] rounded-t-xl bg-transparent no-scrollbar w-full ${t.loading?"animate-pulse":""}`),B(z,`display: ${x().tab==te.search?"block":"none"};`)}),ze(j,()=>n(E),e=>Z(E,e)),D(3,H,()=>ye,()=>({duration:500,y:-100})),D(3,z,()=>re,()=>({duration:1e3})),u(ne,G),ke(),oe()}Se(["keyup","click"]);export{Qe as default};
